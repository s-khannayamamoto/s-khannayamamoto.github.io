<!DOCTYPE HTML>
<html>

<head>
	<title>Payload</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
</head>

<body class="is-preload">
	<div id="page-wrapper">

		<!-- Header -->
		<header id="header">
			<!--
			<h1 id="logo"><a href="index.html">Palo Alto Dynamics</a></h1>
			-->
			<nav id="nav">
				<ul>
					<li><a href="index.html">Home</a></li>
					<li>
						<a href="#">Architecture</a>
						<ul>
							<li><a href="chassis.html">Chassis</a></li>
							<li><a href="drive.html">Drive</a></li>
							<li><a href="payload.html">Payload</a></li>
							<li><a href="sensing.html">Sensing</a></li>
							<li><a href="code.html">Control</a></li>
						</ul>
					</li>
					<li><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstley"
							class="button primary">Sign Up</a></li>
				</ul>
			</nav>
		</header>

		<!-- Main -->
		<div id="main" class="wrapper style1">
			<div class="container">
				<header class="major">
					<h2>Code and Gameplay</h2>
					<p>Strategy and Control</p>
					<!--
					<p>Ipsum dolor feugiat aliquam tempus sed magna lorem consequat accumsan</p>
					-->
				</header>
				<div class="row gtr-150">
					<div class="col-4 col-12-medium">

						<!-- Sidebar -->
						<section id="sidebar">
							<h3>Modular Control Components</h3>
							<hr />
							<section>
								<h4>Start Zone Orientation</h4>
								<p>To resolve start zone orientation, precise measurements were taken inside the start
									zone. It was determined that the LiDAR sensors were sufficiently accurate that
									orientation, with the front sensor facing the goal, was resolvable by summing
									front+rear measurements and left+right measurements and comparing them with the true
									dimensions of the board. The robot then determined whether it was on the left board
									or the right board depending on whether the left or right sensor read a smaller
									value, and began translating left or right to contact the wall for minor orientation
									correction accordingly.
								</p>
								<h4>Forward</h4>
								<p>(-R_front, -R_rear, +L_front, +L_rear).</p>
								<h4>Reverse</h4>
								<p>(+R_front, +R_rear, -L_front, -L_rear).</p>
								<h4>Left</h4>
								<p>(-R_front, +R_rear, -L_front, +L_rear).</p>
								<h4>Right</h4>
								<p>(+R_front, -R_rear, +L_front, -L_rear).</p>
							</section>
						</section>

					</div>
					<div class="col-8 col-12-medium imp-medium">

						<!-- Content -->
						<section id="content">
							<a href="#" class="image fit"><img src="images/gameplay_photo.jpg" alt="" /></a>
							<h3>High-Level and Design Considerations</h3>
							<p>With our sensor setup requiring significant processing power, and with our motor control
								scheme requiring precise timing and synchronization, we determined that our minimal
								computing configuration would consist of two Arduino Unos communicating via UART.
								Instructions for robot movement would be handled by the primary Arduino, which was also
								responsible for sensor communication. Granular motor control was handled by the
								secondary Arduino. Motor control instructions (Forward, Reverse, Left, Right with power
								level) were sent via UART from the primary Arduino to the secondary Arduino.
							</p>
							<hr />
							<section>
								<h4>Robot Control</h4>
								<p>Robot movement was and game playing were controlled by the primary Arduino. The
									control sequence was broken into two phases, in accordance with the game rules and
									points scoring structure. In the first phase, the robot would first contact the
									contact zone, then deposit balls at the goal, then (possibly) climb the ramp, and
									return to the starting zone. In the second phase, having maximized one-time points,
									the robot would lap from the start zone to the goal as fast as possible to maximize
									uncapped points.
								</p>
								<p>Phase 1 was comprised of start zone orientation, translation until the frontal and
									side distance measurements indicated that the robot was centered in the gap between
									the start zone and the goal zone, movement and translation to the contact zone and
									goal zone, ramp climbing, and return to the start zone. While we retained the ramp
									for checkoff, because the ramp point bonus was small (4 points) for a significant
									time penalty of approximately 20 seconds, we eliminated the ramp from the Phase 1
									control sequence for the competition and elected to only deposit balls in Phases 1
									and 2.
								</p>
								<a href="#" class="image fit"><img src="images/phase1.jpg" alt="" /></a>
								<p>Phase 2 was comprised of start zone orientation via wall contact, followed by a
									translate-forward-translate-ball drop-translate-reverse-translate sequence, with
									transitions determined through frequent coordinate determination.
								</p>
								<a href="#" class="image fit"><img src="images/phase2.jpg" alt="" /></a>
							</section>
							<hr />
							<section>
								<h4>Speed and Direction Control</h4>
								<p>Speed and direction were directly controlled by the secondary Arduino. With control
									commands sent by the primary Arduino via a UART connection, the motor control
									Arduino only had to execute each command without significant delay between command
									for the first motor and command for the last motor.
								</p>
								<p>Through extensive modularization, we managed to minimize control latency to
									manageable levels. However, due to wheel slippage, we still encountered issues with
									precise robot orientation maintenance through each lap of the course.
								</p>
							</section>
							<hr />
							<section>
								<h4>Inter-Computer Communication</h4>
								<p>Inter-computer communication was handled through a UART connection between the two
									Arduinos. This was possible because the sensors communicated with the primary
									Arduino via I2C.
								</p>
								<p>For speed, the control commands were sent from the primary Arduino as a single byte,
									with the most significant four bits representing the motor command (forward,
									reverse, left, right, single-motor control), and the least significant four bits
									representing the power level (mapped from the 0:15 range allowed with four bits onto
									the 0:1000 range required for stepper motor control from 0 steps/sec to 1000
									steps/sec). Encoding and decoding are shown below:
								</p>
								<pre><code>
									// encode command
									void send_control_command( int command, int power_level ) {
									command = command << 4;
									byte bitVal = command + power_level;
									Serial.write(bitVal);
									}
								</code></pre>
								<pre><code>
									// decode command
									byte data_recv = Serial.read();
									int command = (data_recv & UPPER_4_BIT_MASK) >> 4;
									int speed = map( data_recv & LOWER_4_BIT_MASK, 0, MAX_PL, 0, MAX_SPEED );
								</code></pre>
							</section>
							<li>Code can be found in the GitHub repository <a
									href="https://github.com/jbaileyiii/ME210/tree/main/Code/final_sketches">here.</a>
							</li>
						</section>

					</div>
				</div>
			</div>
		</div>

		<!-- Footer -->
		<footer id="footer">
			<ul class="icons">
				<li><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstley"
						class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
				<li><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstley"
						class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
				<li><a href="https://www.linkedin.com/in/barackobama/" class="icon brands alt fa-linkedin-in"><span
							class="label">LinkedIn</span></a></li>
				<li><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstley"
						class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
				<li><a href="https://github.com/karpathy" class="icon brands alt fa-github"><span
							class="label">GitHub</span></a></li>
				<li><a href="#" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>
			</ul>
			<ul class="copyright">
				<li>&copy; Palo Alto Dynamics. All rights reserved.</li>
			</ul>
		</footer>

	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.scrolly.min.js"></script>
	<script src="assets/js/jquery.dropotron.min.js"></script>
	<script src="assets/js/jquery.scrollex.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

</body>

</html>